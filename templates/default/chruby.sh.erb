source /usr/local/chruby/share/chruby/chruby.sh
<%= node['chruby']['auto_switch'] && "/usr/local/chruby/share/chruby/auto.sh" %>
<% if ::File.exists?("/opt/chef/embedded") -%>
RUBIES+=(/opt/chef/embedded)
<% end -%>

<% if node['chruby']['use_rvm'] -%>
<% unless Dir["~/.rubies/*"].empty? -%>
RUBIES+=($HOME/.rvm/rubies/*)
<% end -%>
<% end -%>

<% if node['chruby']['use_rbenv'] -%>
<% unless Dir["~/.rbenv/versions/*"].empty? -%>
RUBIES+=($HOME/.rbenv/rubies/*)
<% end -%>
<% end -%>

<% if ::File.exists?("/opt/chef/embedded") and node['chruby']['default'] == "embedded" -%>
chruby embedded
<% else -%>
chruby <%= node['chruby']['default'] %>
<% end -%>
